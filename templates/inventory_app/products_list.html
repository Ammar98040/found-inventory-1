<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
    {% load static %}
    <link rel="icon" type="image/svg+xml" href="{% static 'img/favicon.svg' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/sidebar.css' %}">
    <link rel="stylesheet" href="{% static 'css/quick_search.css' %}">
    <link rel="stylesheet" href="{% static 'css/notifications.css' %}">
    <link rel="stylesheet" href="{% static 'css/product_buttons.css' %}">
    
    <style>
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .actions-bar {
            position: relative;
            display: inline-block;
        }
        .fixed-actions {
            display: inline-flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-inline-end: 8px;
            vertical-align: middle;
        }
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            box-shadow: var(--shadow-md);
            padding: 8px;
            min-width: 240px;
            display: none;
            z-index: 1000;
        }
        .dropdown-menu.open {
            display: block;
        }
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            padding: 10px 12px;
            border-radius: 6px;
            text-decoration: none;
            color: var(--text-primary);
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
        }
        .dropdown-item:hover {
            background: #f8fafc;
        }
        @media (max-width: 768px) {
            .page-header > div {
                display: grid;
                grid-template-columns: 1fr;
                gap: 8px;
            }
            .fixed-actions {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 6px;
            }
            .list-actions {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            .list-actions .fixed-actions {
                width: 100%;
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            .list-actions .fixed-actions .btn {
                width: 100%;
            }
            #actions-toggle {
                width: 100%;
            }
            .dropdown-menu {
                position: static;
                width: 100%;
                min-width: unset;
            }
        }
        /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø²Ø±Ø§Ø± Ù…ÙˆØ­Ø¯Ø© Ù…Ù† product_buttons.css */
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .search-box input {
            flex: 1;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            /* overflow: hidden; ØªÙ… Ø¥Ø²Ø§Ù„ØªÙ‡ Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¸Ù‡ÙˆØ± Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© */
            table-layout: fixed; /* Ù„Ø¶Ù…Ø§Ù† Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ù„Ø£Ø¹Ù…Ø¯Ø© */
        }
        th, td {
            padding: 12px 5px;
            text-align: center; /* ØªÙˆØ³ÙŠØ· Ø§Ù„Ù†Øµ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ */
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
            word-wrap: break-word; /* Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù„Ù Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„ */
        }
        
        /* New Styles for Mobile Actions */
        .desktop-only { display: inline-flex; }
        .mobile-only { display: none; }
        
        @media (max-width: 768px) {
            .desktop-only { display: none !important; }
            .mobile-only { display: flex !important; }
            
            .mobile-actions-bar {
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
                gap: 10px;
                margin-bottom: 10px;
            }
            
            .action-dropdown {
                position: relative;
                display: inline-block;
            }
            
            .action-dropdown-content {
                display: none;
                position: absolute;
                left: 0; 
                top: 100%;
                background-color: white;
                min-width: 220px;
                box-shadow: 0 8px 16px rgba(0,0,0,0.2);
                z-index: 1000;
                border-radius: 8px;
                border: 1px solid #e5e7eb;
                flex-direction: column;
                max-height: 60vh; /* ØªØ­Ø¯ÙŠØ¯ Ø£Ù‚ØµÙ‰ Ø§Ø±ØªÙØ§Ø¹ */
                overflow-y: auto; /* ØªÙ…ÙƒÙŠÙ† Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ */
                -webkit-overflow-scrolling: touch; /* ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ */
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
            .action-dropdown-content::-webkit-scrollbar {
                width: 6px;
            }
            .action-dropdown-content::-webkit-scrollbar-track {
                background: #f1f1f1;
            }
            .action-dropdown-content::-webkit-scrollbar-thumb {
                background: #888;
                border-radius: 3px;
            }
            
            .action-dropdown-content.show {
                display: flex;
            }
            
            .action-dropdown-content a, .action-dropdown-content button {
                padding: 12px 16px;
                text-decoration: none;
                display: block;
                color: #374151;
                border-bottom: 1px solid #f3f4f6;
                text-align: right;
                background: none;
                border: none;
                width: 100%;
                font-size: 0.95rem;
                cursor: pointer;
            }
            
            /* Kebab Menu for Rows */
            .kebab-menu-container {
                position: relative;
                display: flex;
                justify-content: center;
            }
            
            .kebab-btn {
                background: none;
                border: none;
                font-size: 1.4rem;
                cursor: pointer;
                color: #4b5563;
                padding: 0 10px;
            }
            
            .kebab-dropdown {
                display: none;
                position: fixed; /* ØªØºÙŠÙŠØ± Ø¥Ù„Ù‰ fixed Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ù‚Øµ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
                left: 0;
                bottom: 0;
                top: auto;
                width: 100%;
                background: white;
                border-top: 1px solid #e5e7eb;
                border-radius: 16px 16px 0 0;
                box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
                z-index: 2000;
                flex-direction: column;
                padding: 10px 0 20px 0;
                animation: slideUp 0.3s ease-out;
            }
            
            @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
            }
            
            .kebab-dropdown.show {
                display: flex;
            }
            
            .kebab-dropdown a, .kebab-dropdown button {
                padding: 15px 20px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ù†Ù‚Ø± */
                text-align: center; /* ØªÙˆØ³ÙŠØ· Ø§Ù„Ù†Øµ */
                border-bottom: 1px solid #f3f4f6;
                color: #374151;
                text-decoration: none;
                font-size: 1rem;
                background: none;
                border: none;
                width: 100%;
                cursor: pointer;
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 10px;
            }
            
            /* Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø¥ØºÙ„Ø§Ù‚ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© */
            .kebab-close-btn {
                padding: 10px;
                text-align: center;
                color: #ef4444;
                font-weight: bold;
                cursor: pointer;
                border-top: 4px solid #f3f4f6;
            }
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ - ØªÙˆØ²ÙŠØ¹ Ù…ØªØ³Ø§ÙˆÙŠ ÙˆØ£Ù†ÙŠÙ‚ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
        /* 1. Ø¹Ù…ÙˆØ¯ Ø§Ù„ØªØ­Ø¯ÙŠØ¯: Ù…Ø³Ø§Ø­Ø© Ø«Ø§Ø¨ØªØ© ØµØºÙŠØ±Ø© */
        th:nth-child(1), td:nth-child(1) { width: 40px; } 
        
        /* 4. Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙˆØ±Ø©: Ù…Ø³Ø§Ø­Ø© Ø«Ø§Ø¨ØªØ© */
        th:nth-child(4), td:nth-child(4) { width: 70px; } 

        /* Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© (7 Ø£Ø¹Ù…Ø¯Ø©) ØªØªØ´Ø§Ø±Ùƒ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ø¨Ø§Ù„ØªØ³Ø§ÙˆÙŠ */
        th:nth-child(2), td:nth-child(2), /* Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ */
        th:nth-child(3), td:nth-child(3), /* Ø§Ù„Ø§Ø³Ù… */
        th:nth-child(5), td:nth-child(5), /* Ø§Ù„Ø³Ø¹Ø± */
        th:nth-child(6), td:nth-child(6), /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© */
        th:nth-child(7), td:nth-child(7), /* Ø§Ù„ÙƒÙ…ÙŠØ© */
        th:nth-child(8), td:nth-child(8), /* Ø§Ù„Ø£Ù…Ø§ÙƒÙ† */
        th:nth-child(9), td:nth-child(9) /* Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
        {
            /* Ø§Ø³ØªØ®Ø¯Ø§Ù… calc Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ø¨Ø§Ù„ØªØ³Ø§ÙˆÙŠ */
            width: calc((100% - 110px) / 7);
        }
        th {
            background: var(--primary-color);
            color: white;
        }
        tr:hover {
            background: #f8fafc;
        }
        .container-badge {
            background: #f8fafc;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            border: 1px solid transparent;
        }
        .color-dot {
            display: inline-block;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 1px solid #e5e7eb;
        }
        
        /* Responsive table */
        @media (max-width: 768px) {
            /* Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ù„Ù„Ù‡ÙˆØ§ØªÙ */
            th, td { width: auto !important; }

            .page-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .page-header h1 {
                margin-bottom: 0;
                font-size: 1.5rem;
            }
            
            .page-header > div {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }
            
            .search-box {
                flex-direction: column;
            }
            .search-box form {
                display: grid !important;
                grid-template-columns: 70% 30%;
                gap: 8px;
                width: 100%;
            }
            .search-box input[name="search"] {
                width: 100%;
            }
            .search-box button[type="submit"] {
                width: 100%;
            }
            .search-box .btn-secondary {
                grid-column: 1 / -1;
                justify-self: start;
            }
            
            table {
                font-size: 0.85rem;
            }
            
            th, td {
                padding: 8px 5px;
                font-size: 0.85rem;
            }
            
            /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ØºÙŠØ± Ø§Ù„Ù…Ù‡Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ */
            /* Ø¥Ø¨Ù‚Ø§Ø¡: Checkbox(1), Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬(2), Ø§Ù„ØµÙˆØ±Ø©(4), Ø§Ù„ÙƒÙ…ÙŠØ©(7), Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª(9) */
            th:nth-child(3), /* Ø§Ù„Ø§Ø³Ù… */
            td:nth-child(3),
            th:nth-child(5), /* Ø§Ù„Ø³Ø¹Ø± */
            td:nth-child(5),
            th:nth-child(6), /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© */
            td:nth-child(6),
            th:nth-child(8), /* Ø§Ù„Ø£Ù…Ø§ÙƒÙ† */
            td:nth-child(8) {
                display: none;
            }
            
            /* ØªØ®ØµÙŠØµ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„Ø£Ø¹Ù…Ø¯Ø©: Ø¹Ù…ÙˆØ¯ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø«Ø§Ø¨ØªØŒ ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ Ø¨Ø§Ù„ØªØ³Ø§ÙˆÙŠ */
            th:nth-child(1), td:nth-child(1) {
                width: 30px !important;
                padding: 8px 2px !important;
            }

            /* ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø¨Ø§Ù„ØªØ³Ø§ÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø£Ø±Ø¨Ø¹Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© */
            th:nth-child(2), td:nth-child(2), /* Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ */
            th:nth-child(4), td:nth-child(4), /* Ø§Ù„ØµÙˆØ±Ø© */
            th:nth-child(7), td:nth-child(7), /* Ø§Ù„ÙƒÙ…ÙŠØ© */
            th:nth-child(9), td:nth-child(9) { /* Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
                width: 22% !important; /* (100% - 30px) / 4 ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ */
                text-align: center !important;
                vertical-align: middle !important;
            }
            
            /* ØªÙ†Ø³ÙŠÙ‚ Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆØ¯ */
            th:nth-child(2), td:nth-child(2) {
                font-size: 0.8rem;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            
            /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙ…ÙŠØ© */
            td:nth-child(7) {
                font-weight: bold;
                font-size: 0.85rem;
            }
            
            /* ØªØµØºÙŠØ± Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
            .row-actions {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 3px;
            }
            
            .row-actions .btn {
                font-size: 0.7rem !important;
                padding: 5px 8px !important;
                white-space: nowrap;
                justify-content: center;
            }
            
            .row-actions .btn .icon {
                font-size: 1rem;
                margin: 0;
            }
            
            .row-actions .btn span.text {
                display: none; /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Øµ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙÙ‚Ø· */
            }
            
            /* Ø¬Ø¹Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø£ÙƒØ¨Ø± ÙˆØ£ÙˆØ¶Ø­ */
            td:nth-child(2) strong {
                font-size: 0.85rem;
                color: #667eea;
            }
            
            /* ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙ…ÙŠØ©ØŒ Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„ØªÙ†Ø³ÙŠÙ‚Ù‡Ø§ */
        }
        
        @media (max-width: 480px) {
            .page-header {
                gap: 8px;
            }
            
            .page-header h1 {
                font-size: 1.3rem;
            }
            
            .btn {
                font-size: 0.75rem;
                padding: 6px 10px;
            }
            
            table {
                font-size: 0.75rem;
            }
            
            th, td {
                padding: 6px 3px;
                font-size: 0.75rem;
            }
            
            /* ØªØµØºÙŠØ± Ø§Ù„ØµÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„ØµØºÙŠØ±Ø© */
            td img {
                width: 40px !important;
                height: 40px !important;
            }
            
            /* ØªØµØºÙŠØ± Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø£ÙƒØ«Ø± */
            .row-actions {
                grid-template-columns: 1fr 1fr;
                gap: 2px;
            }
            
            .row-actions .btn {
                font-size: 0.6rem !important;
                padding: 4px 6px !important;
            }
            
            .row-actions .btn .icon {
                font-size: 0.9rem;
            }
            
            /* Ø¬Ø¹Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø£ÙƒØ¨Ø± */
            td:nth-child(2) strong {
                font-size: 0.9rem;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ…ÙŠØ© */
            td:nth-child(7) {
                font-size: 0.85rem;
                font-weight: 700;
            }
            
            /* Make tables scroll on very small screens */
            .table-wrapper {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠØ© */
            .page-header .btn {
                font-size: 0.7rem !important;
                padding: 6px 10px !important;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« */
            .search-box input {
                font-size: 0.85rem;
                padding: 8px;
            }
            
            .search-box .btn {
                font-size: 0.75rem;
                padding: 8px 12px;
            }
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ù„ØµÙˆØ±Ø© (Modal) */
        .image-modal {
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
            position: fixed;
            z-index: 10000; /* ÙÙˆÙ‚ ÙƒÙ„ Ø´ÙŠØ¡ */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: rgba(0,0,0,0.85); /* Ø®Ù„ÙÙŠØ© Ù…Ø¹ØªÙ…Ø© */
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .image-modal-content {
            width: 50vw; /* 50% Ù…Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø§Ø´Ø© ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª */
            max-height: 80vh;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            animation: zoomIn 0.3s ease-out;
            cursor: default; /* Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© */
        }
        
        /* ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙƒØ¨ÙŠØ± */
        @keyframes zoomIn {
            from {transform: scale(0.5); opacity: 0;}
            to {transform: scale(1); opacity: 1;}
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…ØµØºØ±Ø© Ù„ØªÙˆØ¶ÙŠØ­ Ø£Ù†Ù‡Ø§ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù†Ù‚Ø± */
        .product-thumbnail {
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .product-thumbnail:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 10;
            position: relative;
        }
    </style>
</head>
<body>
    {% csrf_token %}
    <div class="container">
        <div class="page-header">
            <h1>ğŸ“¦ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>
        </div>

        <!-- Ø§Ù„Ø¨Ø­Ø« -->
        <div class="search-box">
            <form method="GET" style="display: flex; gap: 10px; width: 100%;">
                <input type="text" name="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." value="{{ search }}" style="flex: 1;">
                <button type="submit" class="btn btn-primary">ğŸ” Ø¨Ø­Ø«</button>
                {% if search %}<a href="/products/" class="btn btn-secondary">ğŸ—‘ï¸ Ù…Ø³Ø­</a>{% endif %}
            </form>
        </div>
        
        <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª -->
        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: var(--shadow-md); margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin: 0; color: #1f2937; font-size: 1.1rem;">ğŸ“¦ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª</h3>
            </div>
            
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <label style="font-weight: 600; color: #4b5563;">ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø¥Ù„Ù‰:</label>
                <select id="container-select" style="padding: 8px 12px; border: 2px solid #e5e7eb; border-radius: 6px; font-size: 0.95rem; min-width: 200px;">
                    <option value="">-- Ø§Ø®ØªØ± Ø­Ø§ÙˆÙŠØ© --</option>
                    <option value="null">âŒ Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø­Ø§ÙˆÙŠØ©</option>
                    {% for container in containers %}
                        <option value="{{ container.id }}" data-color="{{ container.color|default:'#667eea' }}">
                            ğŸ“¦ {{ container.name }} ({{ container.get_products_count }} Ù…Ù†ØªØ¬)
                        </option>
                    {% endfor %}
                </select>
                <button onclick="assignToContainer()" class="btn btn--sm btn--primary">
                    âœ“ ØªØ·Ø¨ÙŠÙ‚
                </button>
                
            </div>
            
            <div id="selected-count" style="margin-top: 10px; color: #6b7280; font-size: 0.9rem;">
                Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ Ù…Ù†ØªØ¬Ø§Øª
            </div>
        </div>

        <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <!-- Ø¥Ø´Ø¹Ø§Ø± ÙÙ„ØªØ±Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ© -->
        {% if selected_container %}
        <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); color: white; display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="font-size: 2rem;">ğŸ“¦</div>
                <div>
                    <div style="font-size: 1.2rem; font-weight: 700;">Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø­Ø§ÙˆÙŠØ©: {{ selected_container.name }}</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">{{ filtered_count }} Ù…Ù†ØªØ¬ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§ÙˆÙŠØ©</div>
                </div>
            </div>
            <a href="{% url 'inventory_app:products_list' %}" class="btn" style="background: white; color: #059669; font-weight: 600;">
                âœ• Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙÙ„ØªØ±Ø©
            </a>
        </div>
        {% endif %}

        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; margin-bottom: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); color: white;">
            <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 20px;">
                <div style="text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 5px;">
                        ğŸ“¦ {{ total_count }}
                    </div>
                    <div style="font-size: 1rem; opacity: 0.9;">
                        Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                    </div>
                </div>
                {% if search %}
                <div style="text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 5px;">
                        ğŸ” {{ filtered_count }}
                    </div>
                    <div style="font-size: 1rem; opacity: 0.9;">
                        Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«
                    </div>
                </div>
                {% endif %}
                {% if selected_container and not search %}
                <div style="text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 5px;">
                        ğŸ“¦ {{ filtered_count }}
                    </div>
                    <div style="font-size: 1rem; opacity: 0.9;">
                        ÙÙŠ Ø§Ù„Ø­Ø§ÙˆÙŠØ©
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: var(--shadow-lg);">
            <div class="list-actions" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 8px; margin-bottom: 12px;">
                
                <!-- Desktop View -->
                <div class="desktop-only" style="width: 100%; justify-content: space-between; align-items: center;">
                    <div class="fixed-actions">
                         <button id="delete-fixed-btn" class="btn btn--sm btn--danger" onclick="deleteSelectedProducts()" style="display: none;">
                            <span class="icon">ğŸ—‘ï¸</span>
                            <span id="delete-fixed-count">Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯ (0)</span>
                        </button>
                    </div>
                    <div class="fixed-actions" style="gap: 8px;">
                        <a href="{% url 'inventory_app:export_products_pdf' %}" class="btn btn--sm" target="_blank" style="background: #334155; color: white;">ğŸ§¾ ØªØµØ¯ÙŠØ± PDF</a>
                        <a href="{% url 'inventory_app:export_products_excel' %}" class="btn btn--sm" style="background: #0ea5e9; color: white;">ğŸ“¥ ØªØµØ¯ÙŠØ± Excel</a>
                        <a href="{% url 'inventory_app:import_products_excel' %}" class="btn btn--sm" style="background: #22c55e; color: white;">ğŸ“¤ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Excel</a>
                        <a href="{% url 'inventory_app:container_list' %}" class="btn btn--sm" style="background: #6366f1; color: white;">ğŸ“‹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª</a>
                        {% if selected_container %}
                            <a href="{% url 'inventory_app:products_list' %}" class="btn btn--sm" style="background: #ef4444; color: white;">âœ• Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙÙ„ØªØ±Ø©</a>
                        {% endif %}
                    </div>
                </div>

                <!-- Mobile View -->
                <div class="mobile-only mobile-actions-bar">
                    <div style="display: flex; gap: 5px;">
                        <a href="{% url 'inventory_app:product_add' %}" class="btn btn--sm btn--primary">
                            <span class="icon">â•</span> Ø¬Ø¯ÙŠØ¯
                        </a>
                        <button id="delete-mobile-btn" class="btn btn--sm btn--danger" onclick="deleteSelectedProducts()" style="display: none;">
                            <span class="icon">ğŸ—‘ï¸</span>
                        </button>
                    </div>
                    
                    <div class="action-dropdown">
                        <button class="btn btn--sm btn--secondary" onclick="toggleMobileActions(event)">
                            Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª â–¾
                        </button>
                        <div id="mobile-actions-dropdown" class="action-dropdown-content">
                             <a href="{% url 'inventory_app:export_products_pdf' %}" target="_blank">ğŸ§¾ ØªØµØ¯ÙŠØ± PDF</a>
                            <a href="{% url 'inventory_app:export_products_excel' %}">ğŸ“¥ ØªØµØ¯ÙŠØ± Excel</a>
                            <a href="{% url 'inventory_app:import_products_excel' %}">ğŸ“¤ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Excel</a>
                            <a href="{% url 'inventory_app:container_list' %}">ğŸ“‹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª</a>
                            {% if selected_container %}
                                <a href="{% url 'inventory_app:products_list' %}" style="color: #ef4444;">âœ• Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙÙ„ØªØ±Ø©</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% if products %}
                <div class="table-wrapper">
                    <table>
                    <thead>
                        <tr>
                            <th>
                                <input type="checkbox" id="select-all" onchange="toggleSelectAll()">
                            </th>
                            <th>Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬</th>
                            <th>Ø§Ù„Ø§Ø³Ù…</th>
                            <th>Ø§Ù„ØµÙˆØ±Ø©</th>
                            <th>Ø§Ù„Ø³Ø¹Ø±</th>
                            <th>Ø§Ù„Ø­Ø§ÙˆÙŠØ©</th>
                            <th>Ø§Ù„ÙƒÙ…ÙŠØ© (Ø­Ø¨Ø©)</th>

                            <th>Ø§Ù„Ø£Ù…Ø§ÙƒÙ†</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for product in products %}
                            <tr>
                                <td>
                                    <input type="checkbox" class="product-checkbox" value="{{ product.id }}">
                                </td>
                                <td><strong>{{ product.product_number }}</strong></td>
                                <td>{{ product.name }}</td>
                                <td>
                                    {% if product.image %}
                                        <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-thumbnail" onclick="openImageModal(this.src)" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px; border: 1px solid #e2e8f0;">
                                    {% else %}
                                        <span style="color: #94a3b8; font-size: 0.85rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if product.price %}
                                        <strong style="color: #059669;">{{ product.price }} Ø±ÙŠØ§Ù„</strong>
                                    {% else %}
                                        <span style="color: #94a3b8; font-size: 0.85rem;">-</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if product.container %}
                                        <span class="container-badge" data-color="{{ product.container.color }}">
                                            ğŸ“¦ {{ product.container.name }}
                                        </span>
                                    {% else %}
                                        <span style="color: #94a3b8; font-size: 0.85rem;">-</span>
                                    {% endif %}
                                </td>
                                <td><strong style="color: #059669;">{{ product.quantity }}</strong></td>


                                <td>
                                    {% if product.location %}
                                        <span style="background: #dcfce7; color: #065f46; padding: 3px 8px; border-radius: 4px; margin: 2px; display: inline-block; font-size: 0.85rem;">
                                            {{ product.location.full_location }}
                                        </span>
                                    {% else %}
                                        <span style="color: var(--text-secondary);">Ø¨Ø¯ÙˆÙ† Ù…ÙˆÙ‚Ø¹</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <!-- Desktop Actions -->
                                    <div class="row-actions desktop-only">
                                        <a href="/products/{{ product.id }}/" class="btn btn--xs btn--info"><span class="icon">ğŸ‘ï¸</span><span class="text">Ø¹Ø±Ø¶</span></a>
                                        <a href="/products/{{ product.id }}/edit/" class="btn btn--xs btn--primary"><span class="icon">âœï¸</span><span class="text">ØªØ¹Ø¯ÙŠÙ„</span></a>
                                        <a href="/products/{{ product.id }}/assign/" class="btn btn--xs btn--success"><span class="icon">ğŸ“</span><span class="text">Ø±Ø¨Ø·</span></a>
                                        <button class="btn btn--xs btn--danger delete-btn" data-product-id="{{ product.id }}" data-product-number="{{ product.product_number }}"><span class="icon">ğŸ—‘ï¸</span><span class="text">Ø­Ø°Ù</span></button>
                                    </div>
                                    
                                    <!-- Mobile Kebab Menu -->
                                    <div class="kebab-menu-container mobile-only">
                                        <button class="kebab-btn" onclick="toggleRowMenu(event, 'row-menu-{{ product.id }}')">â‹®</button>
                                        <div id="row-menu-{{ product.id }}" class="kebab-dropdown">
                                            <a href="/products/{{ product.id }}/">ğŸ‘ï¸ Ø¹Ø±Ø¶</a>
                                            <a href="/products/{{ product.id }}/edit/">âœï¸ ØªØ¹Ø¯ÙŠÙ„</a>
                                            <a href="/products/{{ product.id }}/assign/">ğŸ“ Ø±Ø¨Ø·</a>
                                            <button class="delete-btn" data-product-id="{{ product.id }}" data-product-number="{{ product.product_number }}">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                                            <div class="kebab-close-btn" onclick="toggleRowMenu(event, 'row-menu-{{ product.id }}')">Ø¥Ù„ØºØ§Ø¡</div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                    </table>
                </div>
                
                
                
                <div style="display: flex; justify-content: flex-end; align-items: center; margin-top: 20px; padding-top: 20px; border-top: 2px solid var(--border-color); gap: 15px;">
                    <button onclick="deleteSelectedProducts()" class="btn btn--sm btn--danger" style="display: none;" id="delete-selected-btn-bottom">
                        <span class="icon">ğŸ—‘ï¸</span>
                        <span id="delete-selected-count-bottom">Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯ (0)</span>
                    </button>
                </div>
            {% else %}
                <p style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    {% if search %}
                        Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ø¨Ø­Ø« "{{ search }}"
                    {% else %}
                        Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. <a href="/products/add/">Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Ù‹ Ø¬Ø¯ÙŠØ¯Ø§Ù‹</a>
                    {% endif %}
                </p>
            {% endif %}
        </div>
    </div>
    
    <!-- Sidebar -->
    <button id="sidebar-toggle" onclick="toggleSidebar()">â˜°</button>
    
    <div id="sidebar-overlay"></div>
    
    <div id="main-sidebar">
        <div class="sidebar-header">
            <h2>ğŸ§­ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…</h2>
            <button class="sidebar-close" onclick="toggleSidebar()">Ã—</button>
        </div>
        
        <!-- Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« -->
        <div class="sidebar-search">
            <input type="text" id="sidebar-search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…..." autocomplete="off">
            <div id="sidebar-search-results"></div>
        </div>
        
        <div class="sidebar-content" id="sidebar-main-content">
            <div class="sidebar-section">
                <div class="sidebar-title">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
                <a href="/" class="sidebar-link">
                    <span class="icon">ğŸ”</span>
                    <span class="text">Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
                </a>
                <a href="/dashboard/" class="sidebar-link">
                    <span class="icon">ğŸ“Š</span>
                    <span class="text">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
                </a>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                <a href="/products/" class="sidebar-link active">
                    <span class="icon">ğŸ“¦</span>
                    <span class="text">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
                </a>
                <a href="/products/add/" class="sidebar-link">
                    <span class="icon">â•</span>
                    <span class="text">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</span>
                </a>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-title">Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹</div>
                <a href="/manage/" class="sidebar-link">
                    <span class="icon">âš™ï¸</span>
                    <span class="text">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹</span>
                </a>
                <a href="/locations/" class="sidebar-link">
                    <span class="icon">ğŸ“</span>
                    <span class="text">Ø§Ù„Ø£Ù…Ø§ÙƒÙ†</span>
                </a>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-title">Ø§Ù„Ø³Ø¬Ù„Ø§Øª</div>
                <a href="/audit-logs/" class="sidebar-link">
                    <span class="icon">ğŸ“‹</span>
                    <span class="text">Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</span>
                </a>
            </div>
            
            
            
            <div class="sidebar-section">
                <div class="sidebar-title">Ø§Ù„ØµÙŠØ§Ù†Ø©</div>
                <a href="/backup-restore/" class="sidebar-link">
                    <span class="icon">ğŸ’¾</span>
                    <span class="text">Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</span>
                </a>
                <a href="/data-deletion/" class="sidebar-link">
                    <span class="icon">ğŸ—‘ï¸</span>
                    <span class="text">Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
                </a>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-title">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­ÙŠØ©</div>
                <div class="stats-container">
                    <!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
                    <div class="stat-category">
                        <div class="stat-category-title">ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                        <div class="stat-item">
                            <div class="stat-icon">ğŸ“¦</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stats-products">-</div>
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
                            </div>
                        </div>
                        <div class="stat-item mini">
                            <div class="stat-icon">âœ…</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stats-products-with-locations">-</div>
                                <div class="stat-label">Ù„Ù‡Ø§ Ù…ÙˆÙ‚Ø¹</div>
                            </div>
                        </div>
                        <div class="stat-item mini">
                            <div class="stat-icon">âŒ</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stats-products-without-locations">-</div>
                                <div class="stat-label">Ø¨Ø¯ÙˆÙ† Ù…ÙˆÙ‚Ø¹</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø§Ù„Ø£Ù…Ø§ÙƒÙ† -->
                    <div class="stat-category">
                        <div class="stat-category-title">ğŸ“ Ø§Ù„Ø£Ù…Ø§ÙƒÙ†</div>
                        <div class="stat-item">
                            <div class="stat-icon">ğŸ“Š</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stats-capacity">-</div>
                                <div class="stat-label">Ø§Ù„Ø³Ø¹Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</div>
                            </div>
                        </div>
                        <div class="stat-item mini">
                            <div class="stat-icon">ğŸŸ¢</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stats-occupied">-</div>
                                <div class="stat-label">Ù…Ø´ØºÙˆÙ„Ø©</div>
                            </div>
                        </div>
                        <div class="stat-item mini">
                            <div class="stat-icon">âšª</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stats-empty">-</div>
                                <div class="stat-label">ÙØ§Ø±ØºØ©</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); font-size: 0.75rem; color: #94a3b8; text-align: center;">
                        ğŸŸ¢ Live Mode - ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 15 Ø«Ø§Ù†ÙŠØ©
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="{% static 'js/sidebar.js' %}"></script>
    <script src="{% static 'js/auto_refresh.js' %}"></script>
    <script src="{% static 'js/quick_search.js' %}"></script>
    <script src="{% static 'js/notifications.js' %}"></script>
    
    <script>
        // ØªØ­Ø¯ÙŠØ¯/Ø¥Ù„ØºØ§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„
        function toggleSelectAll() {
            const selectAll = document.getElementById('select-all');
            const checkboxes = document.querySelectorAll('.product-checkbox');
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
            });
            
            updateSelectedCount();
        }
        
        
        // Ø­Ø°Ù Ù…Ù†ØªØ¬ ÙˆØ§Ø­Ø¯
        function deleteProduct(productId, productNumber) {
            if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ "${productNumber}"ØŸ`)) {
                return;
            }
            
            fetch(`/products/${productId}/delete/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({})
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                    window.location.reload();
                } else {
                    alert('Ø®Ø·Ø£: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬');
            });
        }
        
        // Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
        function deleteSelectedProducts() {
            const checkboxes = document.querySelectorAll('.product-checkbox:checked');
            
            if (checkboxes.length === 0) {
                alert('Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ Ù…Ù†ØªØ¬');
                return;
            }
            
            const productIds = Array.from(checkboxes).map(cb => parseInt(cb.value));
            const count = productIds.length;
            
            if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ${count} Ù…Ù†ØªØ¬ØŸ`)) {
                return;
            }
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ù„Ù„Ø­Ø°Ù
            fetch('/api/delete-products-bulk/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({
                    product_ids: productIds
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(`ØªÙ… Ø­Ø°Ù ${count} Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­`);
                    window.location.reload();
                } else {
                    alert('Ø®Ø·Ø£: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª');
            });
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø²Ù† ÙÙŠ Ø§Ù„ÙƒØ±ØªÙˆÙ†
        function updateDozensPerCarton(productId, value) {
            if (!value || value < 1) {
                alert('ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¹Ø¯Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø²Ù† ÙÙŠ Ø§Ù„ÙƒØ±ØªÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† 0');
                return;
            }
            
            fetch(`/api/products/${productId}/update-dozens-per-carton/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify({
                    dozens_per_carton: parseInt(value)
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                    location.reload();
                } else {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£: ' + (data.error || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            });
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
        function updateSelectedCount() {
            const checkboxes = document.querySelectorAll('.product-checkbox:checked');
            const count = checkboxes.length;
            const infoDiv = document.getElementById('selected-count');
            const topBtn = document.getElementById('delete-selected-btn-top');
            const bottomBtn = document.getElementById('delete-selected-btn-bottom');
            const topText = document.getElementById('delete-selected-count-top');
            const bottomText = document.getElementById('delete-selected-count-bottom');
            const fixedBtn = document.getElementById('delete-fixed-btn');
            const fixedText = document.getElementById('delete-fixed-count');
            const mobileBtn = document.getElementById('delete-mobile-btn');
            
            if (count === 0) {
                if (infoDiv) { infoDiv.textContent = 'Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ Ù…Ù†ØªØ¬Ø§Øª'; infoDiv.style.color = '#6b7280'; }
                if (topBtn) topBtn.style.display = 'none';
                if (bottomBtn) bottomBtn.style.display = 'none';
                if (fixedBtn) fixedBtn.style.display = 'none';
                if (mobileBtn) mobileBtn.style.display = 'none';
            } else {
                if (infoDiv) { infoDiv.textContent = `ØªÙ… ØªØ­Ø¯ÙŠØ¯ ${count} Ù…Ù†ØªØ¬`; infoDiv.style.color = '#059669'; infoDiv.style.fontWeight = '600'; }
                if (topBtn) topBtn.style.display = 'inline-flex';
                if (bottomBtn) bottomBtn.style.display = 'inline-flex';
                if (topText) topText.textContent = `Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯ (${count})`;
                if (bottomText) bottomText.textContent = `Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯ (${count})`;
                if (fixedBtn) fixedBtn.style.display = 'inline-flex';
                if (fixedText) fixedText.textContent = `Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯ (${count})`;
                if (mobileBtn) mobileBtn.style.display = 'inline-flex';
            }
        }

        // Mobile Menu Toggles
        function toggleMobileActions(event) {
            event.stopPropagation();
            const dropdown = document.getElementById('mobile-actions-dropdown');
            dropdown.classList.toggle('show');
            // Close row menus
            document.querySelectorAll('.kebab-dropdown').forEach(d => d.classList.remove('show'));
        }

        function toggleRowMenu(event, menuId) {
            event.stopPropagation();
            // Close other menus
            document.querySelectorAll('.kebab-dropdown').forEach(d => {
                if(d.id !== menuId) d.classList.remove('show');
            });
            document.getElementById('mobile-actions-dropdown')?.classList.remove('show');
            
            const menu = document.getElementById(menuId);
            menu.classList.toggle('show');
        }

        // Close menus when clicking outside
        document.addEventListener('click', function() {
            document.getElementById('mobile-actions-dropdown')?.classList.remove('show');
            document.querySelectorAll('.kebab-dropdown').forEach(d => d.classList.remove('show'));
        });
        
        // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØºÙŠÙŠØ±Ø§Øª Checkboxes
        document.addEventListener('DOMContentLoaded', function() {
            const checkboxes = document.querySelectorAll('.product-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', updateSelectedCount);
            });
            
            const selectAll = document.getElementById('select-all');
            if (selectAll) {
                selectAll.addEventListener('change', function() {
                    setTimeout(updateSelectedCount, 50);
                });
            }

            const dozensInputs = document.querySelectorAll('.dozens-input');
            dozensInputs.forEach(input => {
                input.addEventListener('change', function() {
                    const productId = parseInt(this.dataset.productId);
                    const value = this.value;
                    updateDozensPerCarton(productId, value);
                });
            });

            const deleteButtons = document.querySelectorAll('.delete-btn');
            deleteButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = parseInt(this.dataset.productId);
                    const productNumber = this.dataset.productNumber;
                    deleteProduct(productId, productNumber);
                });
            });

            const badges = document.querySelectorAll('.container-badge[data-color]');
            badges.forEach(el => {
                const color = el.dataset.color;
                if (color) {
                    el.style.color = color;
                    el.style.borderColor = color;
                }
            });

            const containerSelect = document.getElementById('container-select');
            if (containerSelect) {
                const options = containerSelect.querySelectorAll('option[data-color]');
                options.forEach(opt => {
                    const color = opt.dataset.color;
                    if (color) opt.style.color = color;
                });
            }

            const actionsToggle = document.getElementById('actions-toggle');
            const actionsMenu = document.getElementById('actions-menu');
            if (actionsToggle && actionsMenu) {
                actionsToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    actionsMenu.classList.toggle('open');
                });
                document.addEventListener('click', function() {
                    actionsMenu.classList.remove('open');
                });
            }
        });
        
        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¥Ù„Ù‰ Ø­Ø§ÙˆÙŠØ©
        function assignToContainer() {
            const checkboxes = document.querySelectorAll('.product-checkbox:checked');
            const productIds = Array.from(checkboxes).map(cb => cb.value);
            const containerId = document.getElementById('container-select').value;
            
            if (productIds.length === 0) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…Ù†ØªØ¬ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
                return;
            }
            
            if (!containerId) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø­Ø§ÙˆÙŠØ©');
                return;
            }
            
            fetch('/api/assign-products-to-container/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify({
                    product_ids: productIds,
                    container_id: containerId === 'null' ? null : containerId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('âœ… ' + data.message);
                    location.reload();
                } else {
                    alert('âŒ Ø®Ø·Ø£: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª');
            });
        }
        
        // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø­Ø§ÙˆÙŠØ©
        function showAddContainerModal() {
            const name = prompt('ğŸ“¦ Ø§Ø³Ù… Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:');
            if (!name || name.trim() === '') {
                return;
            }
            
            const description = prompt('ğŸ“ ÙˆØµÙ Ø§Ù„Ø­Ø§ÙˆÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):');
            const color = prompt('ğŸ¨ Ù„ÙˆÙ† Ø§Ù„Ø­Ø§ÙˆÙŠØ© (Ù…Ø«Ø§Ù„: #667eea):', '#667eea');
            
            fetch('/api/container/add/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: new URLSearchParams({
                    name: name.trim(),
                    description: description || '',
                    color: color || '#667eea'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('âœ… ' + data.message);
                    location.reload();
                } else {
                    alert('âŒ Ø®Ø·Ø£: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§ÙˆÙŠØ©');
            });
        }
    </script>
    <!-- Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…ÙƒØ¨Ø±Ø© -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <img class="image-modal-content" id="modalImage" onclick="event.stopPropagation()">
    </div>

    <script>
        function openImageModal(src) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            modal.style.display = 'flex';
            modalImg.src = src;
            document.body.style.overflow = 'hidden'; // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
        }
        
        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ±
        }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === "Escape") {
                closeImageModal();
            }
        });
    </script>
</body>

</html>
