{% extends 'base.html' %}

{% block title %}Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª{% endblock %}

{% block content %}
<style>
    .container-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        margin-bottom: 20px;
        border-left: 5px solid;
        transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .container-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .container-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }
    
    .container-title {
        font-size: 1.3rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .container-badge {
        background: #f3f4f6;
        color: #4b5563;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
    }
    
    .container-description {
        color: #6b7280;
        font-size: 0.95rem;
        margin-bottom: 15px;
    }
    
    .container-actions {
        display: flex;
        gap: 10px;
    }
    
    .btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 600;
        transition: all 0.2s;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 5px;
    }
    
    .btn-primary {
        background: #3b82f6;
        color: white;
    }
    
    .btn-primary:hover {
        background: #2563eb;
    }
    
    .btn-danger {
        background: #ef4444;
        color: white;
    }
    
    .btn-danger:hover {
        background: #dc2626;
    }
    
    .btn-success {
        background: #10b981;
        color: white;
    }
    
    .btn-success:hover {
        background: #059669;
    }
    
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #9ca3af;
    }
    
    .empty-state-icon {
        font-size: 4rem;
        margin-bottom: 20px;
    }
    
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 30px;
        border-radius: 12px;
        color: white;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .stat-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        text-align: center;
    }
    
    .stat-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: #667eea;
        margin-bottom: 5px;
    }
    
    .stat-label {
        color: #6b7280;
        font-size: 0.9rem;
    }
</style>

<div class="page-header">
    <div>
        <h1 style="margin: 0; font-size: 2rem;">ğŸ“¦ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª</h1>
        <p style="margin: 10px 0 0 0; opacity: 0.9;">ØªÙ†Ø¸ÙŠÙ… ÙˆØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø­Ø§ÙˆÙŠØ§Øª</p>
    </div>
    <div>
        <button onclick="showAddContainerModal()" class="btn btn-success">
            â• Ø¥Ø¶Ø§ÙØ© Ø­Ø§ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
        </button>
        <a href="{% url 'inventory_app:products_list' %}" class="btn" style="background: white; color: #667eea;">
            â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª
        </a>
    </div>
</div>

<!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-value">{{ total_containers }}</div>
        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ containers|length }}</div>
        <div class="stat-label">Ø­Ø§ÙˆÙŠØ§Øª Ù†Ø´Ø·Ø©</div>
    </div>
</div>

<!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª -->
{% if containers %}
    <div style="display: grid; gap: 20px;">
        {% for container in containers %}
            <div class="container-card" data-color="{{ container.color }}">
                <div class="container-header">
                    <div class="container-title">
                        <span>ğŸ“¦</span>
                        <span>{{ container.name }}</span>
                        <span class="container-badge">{{ container.products_count }} Ù…Ù†ØªØ¬</span>
                    </div>
                    <div class="container-actions">
                        <a href="{% url 'inventory_app:products_list' %}?container={{ container.id }}" class="btn btn-primary">
                            ğŸ‘ï¸ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                        </a>
                        <button class="btn btn-danger delete-container-btn" data-id="{{ container.id }}" data-name="{{ container.name }}">
                            ğŸ—‘ï¸ Ø­Ø°Ù
                        </button>
                    </div>
                </div>
                
                {% if container.description %}
                    <div class="container-description">
                        {{ container.description }}
                    </div>
                {% endif %}
                
                <div style="display: flex; gap: 15px; color: #9ca3af; font-size: 0.85rem;">
                    <span>ğŸ¨ Ø§Ù„Ù„ÙˆÙ†: <span data-color-text style="font-weight: 600;">{{ container.color }}</span></span>
                    <span>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: {{ container.created_at|date:"Y-m-d" }}</span>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="empty-state">
        <div class="empty-state-icon">ğŸ“¦</div>
        <h2>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø§ÙˆÙŠØ§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</h2>
        <p>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø­Ø§ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªÙ†Ø¸ÙŠÙ… Ù…Ù†ØªØ¬Ø§ØªÙƒ</p>
        <button onclick="showAddContainerModal()" class="btn btn-success" style="margin-top: 20px;">
            â• Ø¥Ø¶Ø§ÙØ© Ø­Ø§ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
        </button>
    </div>
{% endif %}

{% csrf_token %}

<script>
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø­Ø§ÙˆÙŠØ©
    function showAddContainerModal() {
        const name = prompt('ğŸ“¦ Ø§Ø³Ù… Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:');
        if (!name || name.trim() === '') {
            return;
        }
        
        const description = prompt('ğŸ“ ÙˆØµÙ Ø§Ù„Ø­Ø§ÙˆÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):');
        const color = prompt('ğŸ¨ Ù„ÙˆÙ† Ø§Ù„Ø­Ø§ÙˆÙŠØ© (Ù…Ø«Ø§Ù„: #667eea):', '#667eea');
        
        fetch('/api/container/add/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
            },
            body: new URLSearchParams({
                name: name.trim(),
                description: description || '',
                color: color || '#667eea'
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('âœ… ' + data.message);
                location.reload();
            } else {
                alert('âŒ Ø®Ø·Ø£: ' + data.error);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§ÙˆÙŠØ©');
        });
    }
    
    // Ø­Ø°Ù Ø­Ø§ÙˆÙŠØ©
    function deleteContainer(containerId, containerName) {
        if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø­Ø§ÙˆÙŠØ© "${containerName}"ØŸ\n\nØ³ÙŠØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§ÙˆÙŠØ© (Ù„Ù† ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù†ÙØ³Ù‡Ø§)`)) {
            return;
        }
        
        fetch(`/api/container/${containerId}/delete/`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('âœ… ' + data.message);
                location.reload();
            } else {
                alert('âŒ Ø®Ø·Ø£: ' + data.error);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø­Ø§ÙˆÙŠØ©');
        });
    }
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.container-card').forEach(function(card) {
            var color = card.getAttribute('data-color');
            if (color) {
                card.style.borderLeftColor = color;
                var title = card.querySelector('.container-title');
                if (title) title.style.color = color;
                var colorText = card.querySelector('[data-color-text]');
                if (colorText) colorText.style.color = color;
            }
        });
        document.querySelectorAll('.delete-container-btn').forEach(function(btn) {
            btn.addEventListener('click', function() {
                var id = this.getAttribute('data-id');
                var name = this.getAttribute('data-name');
                deleteContainer(id, name);
            });
        });
    });
</script>
{% endblock %}

